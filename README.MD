# 📝 소개




#### 한 서버 내에서 블랙프라이데이, 수강신청, 이벤트 등 높은 트래픽에 대처하기 위한 Architecture 설계

## 기술 스택

- **Spring Boot, Java, JPA, RabbitMQ**
  <br/>
  <br/>

## 목차

**1. 계기**
<br>
**2. Architecture**
<br>
**3. 주요 로직**
<br/>
**4. 설계를 통한 이점**
<br/>
<br/>


# 👩‍💻 계기

- **하나의 서버 내에서 아키텍처 설계를 통한 이점을 가져보자**
  - **각 계층을 분리, 결합도 감소 및 응집도 증가를 통한 확장성 있는 구조의 이점 존재**
  - **필요 이상으로 서버를 띄우는 것은 자원 및 비용 낭비**'
  - **하나의 서버 내에서 설계를 통한 트래픽 처리의 이점을 갖기 위함**
  - **직렬적으로 설계시 병목현상 발생, 동적인 대처 불가능**
  - **요청 실패시 데이터 보관 유실 방지**
  - **요청 실패 레이어에서 우선순위를 다시 받아 시도함으로써 에러 대처**

<br/>
<br/>
<br/>


# 🔨 Architecture

- **하나의 EC2 안에 Gateway API, Auth, 각 서비스 레이어를 컨테이너로 띄우는 것으로 가정**
- **Auth 컨테이너의 인증/인가가 완료되면 RabbitMQ를 통해 라우팅 키에 매핑되는 서비스 컨테이너 호출**
![image](https://github.com/user-attachments/assets/8a15ffcf-404c-4f48-89b9-8374ab7491ae)

<br/>
<br/>

# 💡 주요 로직
- **클라이언트가 Gateway API에 요청**
- **Gateway API가 Auth 서버에 인증/인가 요청 Auth 서버는 Gateway에 Passport 객체 전달**
- **Gateway API가 Passport, 요청값을 라우팅 키에 적합한 큐에 전달함으로써 서비스 레이어에 전달**

<br/>
<br/>

# 🌟  설계를 통한 이점
-  **확장성**
  - **트래픽이 많이 요구되는 시점(블랙 프라이데이, 수강신청 등) 해당 큐, 서비스에 대한 컨테이너를 더 띄우고 트래픽이 감소되면 다시 롤백함으로써 동적인 대처가 가능합니다**
  - **인증/인가, 서비스, Gateway를 모두 구분함으로써, 각 레이어에 대한 유지보수 및 변경이 용이합니다.**
- **사용자 경험 개선 및 리소스 낭비**
  - **실패한 서비스 레이어에서 우선순위 메시지를 통해 다시 시도합니다. 요청 실패시 처음부터 다시 실행하는 것이 아닌 해당 레이어에서 시도함으로써 사용자 경험을 개선 및 리소스 낭비를 방지하고자 했습니다.**
  - **병렬적 구조로 구성해 병목현상에 대한 사용자의 불편함을 감소키고자 했습니다.**
- **데이터 유실 방지가 가능합니다.**
  - **큐에 보관함으로써 데이터 유실 방지가 가능하고, 요청 실패 시에도 데드레터 큐를 통해 요청 실패에 대한 데이터를 보관할 수 있습니다.**




<hr/>




